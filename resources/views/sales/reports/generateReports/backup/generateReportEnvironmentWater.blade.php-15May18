<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
	.page-break-always{ page-break-after: always;}
	.page-break-auto{ page-break-after:auto;}
	@page { margin: 275px 20px 20px;font-size:13px;}	
	#header {left: 0;position: fixed;right: 0;text-align: center;top: -265px;width: 100%;height:auto;}
	#footer {left: 0;position: fixed;right: 0;bottom:5px;width: 100%;height:auto;}
	#content {bottom: 0;height:auto;left: 0;right: 0;width: 100%;}
	td table td {border-bottom: 0px!important;}
	p{padding:2!important;margin:0!important;}
	.category{font-size:13px!important;padding:0 5px!important;overflow-wrap: break-word;word-wrap: break-word;}
	.parameter{font-size:12px!important;padding:0 5px!important;overflow-wrap: break-word;word-wrap: break-word;}
	.methodName{font-size:11px!important;padding:0 5px!important;overflow-wrap: break-word;word-wrap: break-word;}
	.equipmentName{font-size:11px!important;padding:0 5px!importantoverflow-wrap: break-word;word-wrap: break-word;}
	.requirementName{font-size:11px!important;padding:0 5px!important;overflow-wrap: break-word;word-wrap: break-word;}
	.testResult{font-size:11px!important;padding:0 5px!important;overflow-wrap: break-word;word-wrap: break-word;}
	.bottom-note{position: absolute;bottom: 150px;}
	.bottom-sign{position: absolute;bottom: 80px;}
	.pdftable{table-layout:fixed;border-collapse: collapse;background: #fff;}
        .pdftable td {text-overflow:ellipsis;overflow:hidden;white-space:wrap;}
    </style>
</head>

<!--- header-->
<div id="header">
    <table width="100%" style="border-collapse:collapse;">
        <tr @if(!empty($hasContainHeaderFooter) && in_array($hasContainHeaderFooter,array('2','3')))style="visibility: hidden;"@endif>
            <td align="left" width="20%" style="border: 0px none ! important; vertical-align: top;"><img src="{{url('/public/images/template_logo.png')}}" style="width:120px" /></td>
            <td width="65%" style="color:#4d64a1;border:0px!important;text-align:center!important;">
                <h3 style="font-family: times of romen; font-weight: 600; color: rgb(77, 100, 161); margin: 0px; font-size: 24px !important;">Interstellar Testing Centre Pvt. Ltd.</h3>
                <h5 style="font-size:15px;margin:0 "><b>(Formaly International Testing Centre)</b></h5>
                <h5 style="font-size:15px;margin:0 "><b>(A Government Approved Test House)</b></h5>
                <h5 style="font-size:15px;margin:0 "><b>86, Industrial Area, Phase-1, Panchkula-134109 (Haryana)</b></h5>
                <p style="font-size:14px;margin:0 ">Phone : (O) 0172-2561543, 2565825</p>
                <p style="font-size:14px;margin:0 ">Visit us : <span style="text-decoration:underline">www.itclabs.com</span>&nbsp; <b>Email :</b> customersupport@itclabs.com</p>
            </td>
            <td align="right" width="15%" style="border: 0px none ! important; color: #d7563a; vertical-align: top; padding: 5px; text-align: center ! important; font-size: 12px ! important;">
                <img src="{{url('/public/images/pharma-logo-right.jpg')}}" width="100px" />
            </td>
        </tr>
        <tr>
            <td colspan="6">
                <table width="100%" style="padding: 0px !important;">
                    <tr>
                        <td width="33.3%" align="left"></td>
                        <td width="33.3%" align="center">
			    <b style="padding: 5px;font-size: 15px; width: 150px;">
			    Test Report
			    @if(!empty($hasContainHeaderFooter) && $hasContainHeaderFooter == '2')
			    (DRAFT)
			    @endif
			    </b>
                        </td>
			<td width="33.3%" align="right">
			    <b style="vertical-align: middle;">Document QF : 2501<br> </b>
			    <span style="font-weight:bold" align="right">
				<script type='text/php'>
				if(isset($pdf)){ 
				    $font = $fontMetrics->get_font('serif','Normal');
				    $size = 10;
				    $y    = $pdf->get_height() - 725;
				    $x    = $pdf->get_width() - 48 - $fontMetrics->get_text_width('1/1', $font, $size);
				    $pdf->page_text($x, $y, 'Page {PAGE_NUM} of {PAGE_COUNT}', $font, $size);
				}
				</script>
			    </span><br />
			</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <table width="100%" border="1" style="padding: 0px !important;border-collapse:collapse">
        <tr>
            <td width="50%">
                <p style="margin-bottom: 27px;"><b>Issued To</b></p>
                <p style="margin: -25px 5px 30px 5px;font-size: 13px">
		    {{!empty($viewData['order']['customer_name']) ? $viewData['order']['customer_name'] : ''}}
		    <br/>{{!empty($viewData['order']['customer_address']) ? $viewData['order']['customer_address'] : ''}}
		    <br/>{{!empty($viewData['order']['city_name']) ? $viewData['order']['city_name'] : ''}}
                </p>
            </td>
            <td width="50%">
                <p style="font-size:13px;padding:1!important;margin:0!important;"><b style="width:105px!important;float:left;">Report No.</b><b>:</b>{{!empty($viewData['order']['order_no']) ? $viewData['order']['order_no'] : ''}}{{!empty($viewData['order']['is_amended_no']) ? '-'.$viewData['order']['is_amended_no'] :'' }}</p>
                <p style="font-size:13px;padding:1!important;margin:0!important;"><b style="width:105px!important;float:left;">Sample Reg. Date </b><b>:</b>{{!empty($viewData['order']['order_date']) ? date(DATEFORMAT,strtotime($viewData['order']['order_date'])) : ''}}</p>
                <p style="font-size:13px;padding:1!important;margin:0!important;"><b style="width:105px!important;float:left;">Report Date</b><b>:</b>{{!empty($viewData['order']['report_date']) ? date(DATEFORMAT,strtotime($viewData['order']['report_date'])) : ''}}</p>
                <!--<p style="font-size:13px;padding:1!important;margin:0!important;"><b style="width:105px!important;float:left;">Report No</b><b>:</b>{{!empty($viewData['order']['report_no']) ? $viewData['order']['report_no'] : ''}}{{!empty($viewData['order']['is_amended_no']) ? '-'.$viewData['order']['is_amended_no'] :'' }}</p>-->
                <p style="font-size:13px;padding:1!important;margin:0!important;"><b style="width:105px!important;float:left;">Customer Ref. No.</b><b>:</b>{{!empty($viewData['order']['reference_no']) ? $viewData['order']['reference_no'] : ''}}</p>
		<p style="font-size:13px;padding:1!important;margin:0!important;"><b style="width:105px!important;float:left;">Letter Dated</b><b>:</b>{{!empty($viewData['order']['letter_no']) ? $viewData['order']['letter_no'] : ''}}</p>
            </td>
        </tr>
    </table>
</div>
<!--- /header end-->

<!--- footer start-->
<div id="footer">
    <table width="100%">
	<tr>
	    <td align="left" width="100%">
		<b style="width:5%;margin: 0px 3px;font-size: 9px;display:inline-block;vertical-align: top;">Note:</b>
		<b style="width:94%;font-size: 9px;display:inline-block;">1.This report is only for the sample tested.&nbsp;2.This report cannot be reproduced except in full, without the permission of authority of Testing Centre&nbsp;3.Sample consumed/not consumed in testing.</b>
	    </td>
	</tr>
    </table>
</div>
<!--- /footer start-->

<?php
$pageCounter = !empty($viewData['order']['test_standard']) && $viewData['order']['test_standard'] == '80' ? 23 : 60;
if(empty($notContainEquipment) && $viewData['order']['test_standard'] == '80'){
    $colspanCounter =   7 ;
}else{
    if(!empty($notContainEquipment) && $viewData['order']['test_standard'] != '80'){
	$colspanCounter =   5 ;
    }elseif(empty($notContainEquipment) && $viewData['order']['test_standard'] != '80'){
	$colspanCounter =   6;
    }
}
?>

<body>
    <div id="content">
	<div class="page-break-auto">
	    <table class="pdftable" width="100%" border="1" style="border:1px solid #000;border-collapse:collapse;font-size:13px!important;">
		<tr width="100%" style="border:1px solid #000;border-collapse:collapse;font-size:13px!important;margin-top:15px!important">
		    <td colspan="{{$colspanCounter}}">
			<table width="100%" style="border-collapse:collapse;">
			    <tr>
				<td align="left" width="49%" style="vertical-align: middle; padding-top: 5px ! important; padding-bottom: 5px ! important; border-top: 1px solid rgb(255, 255, 255);"><b>Test Report as per IS</b></td>
				<td align="left" width="50%" style="vertical-align: middle; padding-top: 5px ! important; padding-bottom: 5px ! important; border-top: 1px solid rgb(255, 255, 255);">{{!empty($viewData['order']['test_std_name']) ? ' : '.$viewData['order']['test_std_name'] : ''}}</td>
			    </tr>
			</table>
		    </td>
		</tr>			
		<tr width="100%" style="border:1px solid #000;border-collapse:collapse;font-size:13px!important;margin-top:15px!important">
		    <td colspan="{{$colspanCounter}}" style="border:0px !important">
			<table width="100%" style="border-collapse:collapse;">
			    @if(!empty($viewData['generalParameters']))
				@foreach($viewData['generalParameters'] as $generalParameters)
				    <tr>
					<td>
					    <table width="100%" style="border-collapse:collapse;">
						<tr>
						    <th align="left">{{strip_tags($generalParameters['categoryName'])}}</th>
						    <th align="left">&nbsp;</th>
						</tr>
						@foreach($generalParameters['categoryParams'] as $key=>$parameterValues)
						    <tr>
							<td style="padding:0px;" align="left" width="50%"><b style="display: inline-block;vertical-align: middle;"><?php echo $parameterValues['test_parameter_name'];?></b></td>
							<td style="padding:0px;" align="left" width="50%"><span style="display: inline-block;vertical-align: middle;">:&nbsp;{{$parameterValues['test_result']}}</span></td>
						    </tr>
						@endforeach
					    </table>
					</td>
				    </tr>
				@endforeach
			    @endif
			</table>
		    </td>
		</tr>
	    </table>
	    
	    <table class="pdftable" width="100%" border="1" style="border:1px solid #000;border-collapse:collapse;font-size:13px!important;">
		<tr>
		    <td align="center" colspan="{{$colspanCounter}}">
			<b style="padding-top:7px!important;padding-bottom:7px!important;font-size:14px!important;display: inline-block;vertical-align: middle;">TEST RESULTS</b>
		    </td>
		</tr>
		<tr>
		    <th align="center" width="5%!important;">S.No.</th>
		    <th align="center" width="{{!empty($notContainEquipment) ? "30%!important;" : "20%!important;" }}">Test Parameter</th>
		    @if(!($notContainEquipment))
		    <th align="center" width="10%!important;">Inst.Used</th>
		    @endif
		    @if(!empty($viewData['order']['test_standard']) && $viewData['order']['test_standard'] == '80')
		    <th align="center" width="{{!empty($notContainEquipment) ? "15%!important;" : "10%!important;" }}">Method</th>
		    <th align="center" width="{{!empty($notContainEquipment) ? "15%!important;" : "10%!important;" }}">Acceptable Limit</th>
		    <th align="center" width="{{!empty($notContainEquipment) ? "15%!important;" : "10%!important;" }}">Permissible Limit<span style="font-size:8px!important;">(Absence of Alternate Source)</span></th>
		    @else
		    <th align="center" width="20%!important;">Method</th>
		    <th align="center" width="{{empty($notContainEquipment) ? "25%!important;" : "30%!important;" }}">Requirement</th>
		    @endif
		    <th align="center" width="{{!empty($notContainEquipment) ? "20%!important;" : "10%!important;" }}">Result</th>
		</tr>
		<tr>
		    <td colspan="{{$colspanCounter}}" style="text-align:left;padding: 5px;"><b>Test Details :</b>&nbsp;
			<span>{{!empty($viewData['order']['header_note']) ? ucfirst($viewData['order']['header_note']) : '' }}</span>
		    </td>
		</tr>
		    
		@if(!empty($viewData['orderParameters']))
		    @foreach($viewData['orderParameters'] as $key => $orderParameterCategoryName)
			
			<tr>
			    <th class="category" align="center">{{$key+1}}.</th>
			    <th class="category" align="left" colspan="{{$colspanCounter-1}}" style="padding:0 5px;">{{trim($orderParameterCategoryName['categoryName'])}}</th>
			</tr>
	    
			@if(!empty($orderParameterCategoryName['categoryParams']))
			    <?php $charNum = 'a';?>
			    @foreach($orderParameterCategoryName['categoryParams'] as $orderParaKey => $orderParameterCategoryParameters)
				<tr>
				    <td class="parameter" width="5%" align="center">{{ $charNum++ }}.</td>
				    <td class="parameter"  width="{{!empty($notContainEquipment) ? "30%" : "20%" }}" align="left"><?php echo trim($orderParameterCategoryParameters['test_parameter_name']);?></td>
					@if(!($notContainEquipment))
					<td align="center" width="5%">{{!empty($orderParameterCategoryParameters['equipment_name']) ? $orderParameterCategoryParameters['equipment_name'] : ''}}</td>
					@endif
				    @if(!empty($orderParameterCategoryParameters['description']))
					<td class="parameter" class="text-justify" colspan="{{empty($notContainEquipment) ? $colspanCounter-3 : $colspanCounter-2}}" align="left" style="padding:0 15px;">{{!empty($orderParameterCategoryParameters['description']) ? trim($orderParameterCategoryParameters['description']) : ''}} </td>
				    @else
					@if(!empty($viewData['order']['test_standard']) && $viewData['order']['test_standard'] == '80')
					    <td class="methodName" align="center" width="{{!empty($notContainEquipment) ? "15%" : "10%" }}"">{{!empty($orderParameterCategoryParameters['method_name']) ? trim($orderParameterCategoryParameters['method_name']) : ''}}</td>
					    <td class="requirementName" align="center" width="{{!empty($notContainEquipment) ? "15%" : "10%" }}"">{{!empty($orderParameterCategoryParameters['standard_value_from']) ? trim($orderParameterCategoryParameters['standard_value_from']) : ''}}</td>
					    <td class="requirementName" align="center" width="{{!empty($notContainEquipment) ? "15%" : "10%" }}"">{{!empty($orderParameterCategoryParameters['standard_value_to']) ? trim($orderParameterCategoryParameters['standard_value_to']) : ''}}</td>
					@else
					    <td class="methodName" align="center" width="20%">{{!empty($orderParameterCategoryParameters['method_name']) ? trim($orderParameterCategoryParameters['method_name']) : ''}}</td>
					    <td class="requirementName" align="center" width="25%">{{!empty($orderParameterCategoryParameters['requirement_from_to']) ? trim($orderParameterCategoryParameters['requirement_from_to']) : ''}}</td>
					@endif
					<td class="testResult" align="center" width="{{!empty($notContainEquipment) ? "20%" : "10%" }}">{{!empty($orderParameterCategoryParameters['test_result']) ? trim($orderParameterCategoryParameters['test_result']) :''}}</td>
				    @endif
				</tr>
			    @endforeach				    
			@endif
		    @endforeach
		@endif		    
		
		<tr>
		    <td colspan="{{$colspanCounter}}" style="padding-top:5px!important;border: 1px solid #fff;margin-top:10px!important;">
			<table class="pdftable" width="100%" style="border-collapse:collapse;">
			    <tr>
				<td width="100%" align="left" style="border: 1px solid #fff;" colspan="{{$colspanCounter}}">&nbsp;</td>
			    </tr>
				
			    <tr>
				<td width="100%" align="left" style="border: 1px solid #fff;overflow-wrap: break-word;word-wrap: break-word;" colspan="{{$colspanCounter}}"><b style="width:50px;display: inline-block;vertical-align: middle;">NOTE :</b> <span style="vertical-align: middle;">{{!empty($viewData['order']['note_value']) ? $viewData['order']['note_value'] : ''}}</span></td>
			    </tr>
				
			    <tr>
				<td width="100%" align="left" style="border: 1px solid #fff;" colspan="{{$colspanCounter}}">&nbsp;</td>
			    </tr>
				
			    <tr>
				<td width="100%" align="left" style="border: 1px solid #fff;overflow-wrap: break-word;word-wrap: break-word;" colspan="{{$colspanCounter}}"><b style="width:150px;font-size:14px!important;display: inline-block;vertical-align: middle;">PART D : REMARKS :</b><span style="vertical-align: middle;">{{!empty($viewData['order']['remark_value']) ? $viewData['order']['remark_value'] : ''}}</span></td>
			    </tr>
			</table>
		    </td>
		</tr>
    
		<tr>
		    <td colspan="{{$colspanCounter}}" style="padding-top:5px!important;border: 1px solid #fff;margin-top:35px!important;">
			<table class="pdftable" width="100%" style="border-collapse:collapse;border-bottom: 1px solid;">
			    <tr>
				<td width="33.3%" align="left" valign="bottom">
				    @if(!empty($viewData['order']['hasMicrobiologicalEquipment']))
					<p style="font-size:10px;padding-top:-5px!important;">
					    <span style="float:right;width:100%;@if(!empty($hasContainHeaderFooter) && in_array($hasContainHeaderFooter,array('2','3')))visibility:hidden;@endif"><img style="width:70px;height:30px;padding-bottom:-6px!important;" alt="{{$viewData['order']['hasMicrobiologicalEquipment']}}" src="{{DOC_ROOT.SIGN_PATH.str_replace(' ','_',strtolower($viewData['order']['hasMicrobiologicalEquipment'])).'.png'}}"/></span>
					</p>
					<p style="font-size:10px;padding-top:-5px!important;">{{!empty($viewData['order']['report_date']) ? date(DATEFORMAT,strtotime($viewData['orderTrackRecord']['reviewing']['report_view_date'])) : '-'}}</p>
					<p style="font-size:13px;padding-top:-5px!important;"><b>{{$viewData['order']['hasMicrobiologicalEquipment']}}</b></p>
					<p style="font-size:13px;padding-top:-5px!important;"><b>[Tech Manager (Micro.)]</b></p>
				    @endif
				</td>
				<td width="33.3%" align="center" valign="bottom">
				    <p style="font-size:10px;padding-top:-5px!important;">
					@if(!empty($viewData['orderTrackRecord']['reviewing']['user_signature']) && file_exists(DOC_ROOT.SIGN_PATH.$viewData['orderTrackRecord']['reviewing']['user_signature']))
					<span style="display:inline-block;width:100%;@if(!empty($hasContainHeaderFooter) && in_array($hasContainHeaderFooter,array('2','3')))visibility:hidden;@endif"><img style="width:70px;height:30px;padding-top:-5px!important;" alt="{{$viewData['orderTrackRecord']['reviewing']['user_signature']}}" src="{{DOC_ROOT.SIGN_PATH.$viewData['orderTrackRecord']['reviewing']['user_signature']}}"/></span></br>
					@endif
					{{$viewData['orderTrackRecord']['reviewing']['username'] ? $viewData['orderTrackRecord']['reviewing']['username'] : '-'}}
				    </p>
				    <p style="font-size:10px;padding-top:-5px!important;">{{!empty($viewData['orderTrackRecord']['reviewing']['report_view_date']) ? date(DATEFORMAT,strtotime($viewData['orderTrackRecord']['reviewing']['report_view_date'])) : '-'}}</p>
				    <p style="font-size:13px;padding-top:-5px!important;"><b>Reviewer</b></p>
				    <p style="font-size:13px;padding-top:-5px!important;"><b>*****End Of Report*****</b></p>
				</td>
				<td width="33.3%" align="right" valign="bottom">
				    <p style="font-size:10px;padding-top:-5px!important;">
					@if(!empty($viewData['orderTrackRecord']['finalizing']['user_signature']) && file_exists(DOC_ROOT.SIGN_PATH.$viewData['orderTrackRecord']['finalizing']['user_signature']))
					<span style="float:right;width:100%;@if(!empty($hasContainHeaderFooter) && in_array($hasContainHeaderFooter,array('2','3')))visibility:hidden;@endif"><img style="width:70px;height:30px;padding-bottom:-6px!important;" alt="{{$viewData['orderTrackRecord']['finalizing']['user_signature']}}" src="{{DOC_ROOT.SIGN_PATH.$viewData['orderTrackRecord']['finalizing']['user_signature']}}"/></span>
					@endif
					<span style="display:inline-block;width:100%;padding-top:-5px!important;">{{!empty($viewData['orderTrackRecord']['finalizing']['report_view_date']) ? date(DATEFORMAT,strtotime($viewData['orderTrackRecord']['finalizing']['report_view_date'])) : '-'}}</span>
				    </p>
				    <p style="font-size:13px;padding-top:-5px!important;"><b>{{!empty($viewData['orderTrackRecord']['finalizing']['username']) ? $viewData['orderTrackRecord']['finalizing']['username'] : '-'}}</b></p>
				    <p style="font-size:13px;padding-top:-5px!important;"><b>[Tech Manager]</b></p>
				</td>
			    </tr>
			</table>
		    </td>
		</tr>
	    </table>	    
	</div>
    </div>
</body>